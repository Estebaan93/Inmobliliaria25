<!-- Views/Inquilino/Index.cshtml -->
@model IEnumerable<Inmobiliaria25.Models.Inquilinos>

@{
  ViewData["Title"] = "Inquilinos";
}

<h2 class="h2-inquilino-background">Gestión de Inquilinos</h2>
<p>
  <a href="@Url.Action("Crear", "Inquilino")" class="btn btn-agregar">Crear Inquilino</a>
</p>

<div class="displayDeFiltros">
  <div class="displayDeFiltros"></div>
  <div class="barraDeBusqueda">
    <form asp-action="BuscarPorDni" method="get" class="d-flex">
      <input type="text" name="dni" placeholder="Buscar por DNI..." class="form-control" />
      <button type="submit" class="btn btn-primary" title="Buscar">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
    </form>
  </div>

  <div class="barraDeBusqueda">
    <form asp-action="BuscarPorApellido" method="get" class="d-flex">
      <input type="text" name="apellido" placeholder="Buscar por apellido..." class="form-control" />
      <button type="submit" class="btn btn-primary" title="Buscar">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
    </form>
  </div>

  <div class="barraDeBusqueda">
    <form asp-action="BuscarPorEmail" method="get" class="d-flex">
      <input type="text" name="email" placeholder="Buscar por email..." class="form-control" />
      <button type="submit" class="btn btn-primary" title="Buscar">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
    </form>
  </div>

  <div class="barraDeBusqueda">
    <form asp-action="DadosDeBaja" method="get">
      <button type="submit" class="btn btn-danger">Dados de baja</button>
    </form>
  </div>
</div>
<table class="table table-even-columns table-striped table-hover table-bordered">
  <thead class="table-dark">
    <tr>
      <th>@Html.DisplayNameFor(model => model.First().Dni)</th>
      <th>@Html.DisplayNameFor(model => model.First().Apellido)</th>
      <th>@Html.DisplayNameFor(model => model.First().Nombre)</th>
      <th>@Html.DisplayNameFor(model => model.First().Telefono)</th>
      <th>@Html.DisplayNameFor(model => model.First().Correo)</th>
      <th></th>
    </tr>
  </thead>
  <tbody id="tablaInquilinos">
    @foreach (var item in Model)
    {
      <tr>
        <td>@Html.DisplayFor(modelItem => item.Dni)</td>
        <td>@Html.DisplayFor(modelItem => item.Apellido)</td>
        <td>@Html.DisplayFor(modelItem => item.Nombre)</td>
        <td>@Html.DisplayFor(modelItem => item.Telefono)</td>
        <td>@Html.DisplayFor(modelItem => item.Correo)</td>
        <td class="d-flex align-items-center w-auto">
          <a href="@Url.Action("Editar", "Inquilino", new { id = item.IdInquilino })" class="btn btn-editbt mx-1">
            <i class="fa-solid fa-pen-to-square"></i>
          </a>
          @if(User.IsInRole("Administrador"))
          {
            <form asp-action="Borrar" class="mx-1 form-borrar-inquilino" method="post" style="display:inline;">
            <input type="hidden" name="id" value="@item.IdInquilino" />
            <button type="submit" class="btn btn-borrarbt" title="Borrar">
              <i class="fa-solid fa-trash"></i>
            </button>
          </form>         
          }
           else
          {
            <button class="btn btn-borrarbt disabled mx-1" title="Sin permiso" disabled>
              <i class="fa-solid fa-trash"></i>
            </button>
          }
         <a class="btn btn-detallebt mx-1" href="/Inquilino/Detalles/@item.IdInquilino">
            <i class="fa-solid fa-list"></i>
          </a>
        </td>
      </tr>
    }
  </tbody>
</table>

<!-- Para la paginacion-->
@if (ViewBag.TotalPages != null && ViewBag.TotalPages > 1)
{
  <nav aria-label="Paginación de inquilinos">
    <ul class="pagination">
      <li class="page-item @(ViewBag.CurrentPage > 1 ? "" : "disabled")">
        <a class="page-link" href="@Url.Action("Index", new { page = (int)ViewBag.CurrentPage - 1 })">« Anterior</a>
      </li>

      @for (int p = 1; p <= (int)ViewBag.TotalPages; p++)
      {
        <li class="page-item @(p == (int)ViewBag.CurrentPage ? "active" : "")">
          <a class="page-link" href="@Url.Action("Index", new { page = p })">@p</a>
        </li>
      }

      <li class="page-item @(ViewBag.CurrentPage < ViewBag.TotalPages ? "" : "disabled")">
        <a class="page-link" href="@Url.Action("Index", new { page = (int)ViewBag.CurrentPage + 1 })">Siguiente »</a>
      </li>
    </ul>
  </nav>
}

@section Scripts {
  <script src="~/js/site.js"></script>
}
